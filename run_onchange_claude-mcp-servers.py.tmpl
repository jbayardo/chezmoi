#!/usr/bin/env -S uv run
# /// script
# requires-python = ">=3.11"
# dependencies = []
# ///
# configuration hash: {{ include (joinPath .chezmoi.sourceDir "dot_claude" "mcp-servers.json.tmpl") | sha256sum }}
"""Sync Claude MCP servers from ~/.claude/mcp-servers.json into ~/.claude.json."""

import json
import sys
from pathlib import Path

claude_json_path = Path.home() / ".claude.json"
mcp_json_path = Path.home() / ".claude" / "mcp-servers.json"

if not claude_json_path.exists():
    print("~/.claude.json not found. Skipping MCP server sync.")
    sys.exit(0)

if not mcp_json_path.exists():
    print("~/.claude/mcp-servers.json not found. Skipping MCP server sync.")
    sys.exit(0)

config = json.loads(claude_json_path.read_text(encoding="utf-8"))
mcp = json.loads(mcp_json_path.read_text(encoding="utf-8"))

config["mcpServers"] = mcp["mcpServers"]

claude_json_path.write_text(json.dumps(config, indent=2, ensure_ascii=False) + "\n", encoding="utf-8")

print("Claude MCP servers synced from ~/.claude/mcp-servers.json")
